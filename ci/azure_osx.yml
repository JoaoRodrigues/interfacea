 jobs:
    - job:
      workspace:
          clean: all

      displayName: Build_Windows
      pool:
        vmImage: 'vs2017-win2016'

      strategy:
        matrix:
          Python36:
            python.version: '3.6'
          Python37:
            python.version: '3.7'
          # Python38:
          #   python.version: '3.8'

      steps:
      - bash: echo "##vso[task.prependpath]$CONDA/bin"
        displayName: Add Conda to PATH

      - bash: sudo chown -R $USER $CONDA
        displayName: Take ownership of conda installation

      - bash: |
          conda update -n base conda pip setuptools -y
          conda create --yes --quiet --name interfacea_build python=%PYTHON_VERSION%
          conda env update --name interfacea_build --file environment.yml
        displayName: Create and Setup Conda Environment
        continueOnError: false

      - bash: |
          source activate interfacea_build
          conda list
        displayName: Check Environment
        continueOnError: false

      - script: |
          source activate interfacea_build
          python setup.py build
          python setup.py install
        displayName: Build & Install
        continueOnError: false

      - script: |
          conda env remove -n interfacea_build
        displayName: Manual Paranoid Cleanup
